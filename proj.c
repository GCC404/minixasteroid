#include <minix/drivers.h>

#include "kbd.h"
#include "mouse.h"
#include "rtc.h"
#include "timer.h"
#include "sprite.h"
#include "video_gr.h"
#include "vbe.h"

#define BACKGROUND 0

static char * penguin[] = {
"64 64 9",
"  14",
". 15",
"+ 8",
"@ 14",
"# 4",
"$ 6",
"% 7",
"& 9",
"* 1",
"                                                                ",
"                                                                ",
"                           +#++#&+#+                            ",
"                        +..%......&.+++                         ",
"                     #...+..+.+.+.#.+.+++                       ",
"                    .*#%..+.%.&.#*+.#%.++++                     ",
"                  #.+.#*#%..+.#*#.%#*#+.++++                    ",
"                 .&.%......#*#.%.+.#&.+%#%++++                  ",
"                #*#..........+.+.+.+.+.++#+++++                 ",
"               &#.+..........%.+.&#*#&#*.+&+++++                ",
"              +.+.............#*#.+.......#++++++               ",
"             #+.+..............+.+..........+++++               ",
"            +&.+%..............%+............+++++              ",
"            ++.+#.............................+++++             ",
"           ++.+%.............#..#..#..........+++++             ",
"          +++.++%..........#    .    #........++++++            ",
"          ++++.+...........#   .     #.....%..+++++++           ",
"          ++%+#+&..........#   .     #........+++++++           ",
"         +++#*+#..%.........#  .    #........%+++++++           ",
"         ++++%+++..%..%......#.#..#...%..%#..+++++++++          ",
"        +++++#+&+#.......%..................++++++++++          ",
"        ++++*++.+++.%.#...@@@@@@@@@@@@...%.+++++++++++          ",
"        +++++#+++%#$#.&.+.%@@@@@@@@@@...#++++++++++++++         ",
"        +++++&+.++++*.#.....@@@@@@@@......+++++++++&+++         ",
"       ++++++++++%#%....%....@@@@@@........+++++++++++%         ",
"       +++++++++++#...........@@@@@.........+++++++++++         ",
"       ++++++++++..............@@@...........+++++++++++        ",
"      +++++++++++...............@.............+++++%+++++       ",
"    ++++++++++++.....................%.........+++++++++++      ",
"   ++++++++++++%.........................%..%..%++++%++++++     ",
"  +++++++++++++...............................#.++++++++++++    ",
" +++++++++++++%..%.........................#.....++++++++++++   ",
"++++++++++++++........................%..%..%.+.%++%++++++++++  ",
"++++++++++++++...................................#++%++++++++++ ",
"    +++++++++...%..%.....................%.+.%#.%.++++++        ",
"       ++++++%....................%...........$.#.#+#%+         ",
"       +++++#........................%..#..+.#.%$%+&+++         ",
"        ++++&.#.%..%....................%...*#.#...+#++         ",
"        ++++..%...........................%..%.+.+.+&++         ",
"        +++++...%.....%.........%...%..+..#.#..#.%.+#+          ",
"        ++++..#...%......%...............&.*.+.*#$#&++          ",
"         +++..*#...%.........%.....#..%...#.%.#%.+..++          ",
"         +++.#...#..............%...%..#..&.#*#.+.+++           ",
"          ++.%.&...%..%..%..........#..*#..+..+.#%.++           ",
"          ++..#..+..........%...%..$..%..+..&#*.+.+++           ",
"           +*.+.....%............#..$.#...+.#.+.+%.+            ",
"           +...%.+.#..%.%..#.%.#..%.#.*#%..&.+.+.+++            ",
"            +.+.......#..%.....%...%.#..&#$#%.+.+.+             ",
"            #..%#*#%....#..+..$..+..+.&#.+.+.+%+#&              ",
"             +.....#*#$.+...%.#...+....+.%#*#.+.+               ",
"              +.+.&..%..%.+.#.&.+..&#+.+.+.+.++++               ",
"               %..+.#.+.+.+.*#..%#.$.+.&#*#&#%.+                ",
"                +.%#*#%#$.%#.+.+.+.+%#$#+%#*+++                 ",
"                 @#.#$#%++.+.%.+.&.#*#%+#$##$#                  ",
"          .@.@@@@@@@@@@$#.++.+.#.+.+%#$......@@@@@@@            ",
"        @@@@@.@.@@@@@@@@@$.+$#&+.+.+@@..@....@.@@@$@@$          ",
"       @@@@@@.@@.@$@$@$$@$@+%#$#&#+@@.@..@@.@.@@$@@$$$$+        ",
"      @@@@@@@@@@@@@$@$@$@$$$+%+.+%$$@@$@@.@.@$@$@$$@$$$$        ",
"       @@@@$@$@$@$$@$$$$$$$#++++++#$@$@$$$$@$$@$$$$$$$$+        ",
"        @$@@$@$@$@$$$$$$$$          $$$$@$$$$$$$$$$$$$+         ",
"          $$@$$$$$$$$$$$               $$$$$$$$$$$$+            ",
"                                                                ",
"                                                                ",
"                                                                "};


static char *spaceship[] = {
"40 100 2",
"  43",
". 0",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
"........................................",
".................. .....................",
".................. .....................",
".................. .....................",
".................. .....................",
".................. .....................",
".................. .....................",
".................. .....................",
".................. .....................",
".................. .....................",
".................   ....................",
".................    ...................",
"................     ...................",
"................     ...................",
"................      ..................",
"...............       ..................",
"...............       ..................",
"...............       ..................",
"...............       ..................",
"...............        .................",
"..............         .................",
"..............         .................",
"..............         .................",
"..............         .................",
"..............          ................",
".............           ................",
".............           ................",
".............           ................",
".............           ................",
".............           ................",
".............           ................",
".............           ................",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"............             ...............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
"...........               ..............",
".....   ...               ....   .......",
".....   ...               ...    .......",
".....   ...               ...    .......",
"....     ..               ...     ......",
"....     ..                ..     ......",
"....     .                 ..     ......",
"....     .                 ..     ......",
"....                              ......",
"....                              ......",
"....                              ......",
"...                                .....",
"...                                .....",
"...                                .....",
"...                                .....",
"...                                .....",
"....                              ......",
"....                              ......",
"....     ....            ...      ......",
"....     ....           .....     ......",
"..        ....         ....        .....",
"..         .....     ......        .....",
"..         ................        .....",
"..         ................        .....",
"..         ................        .....",
"........................................",
"........................................"};

int main(int argc, char **argv) {

	endpoint_t ep;
	char name[256];
	int priv_f;
	char* video_mem; //ja em video_gr, descobrir como 'herdar'
	Sprite* sprites[2];

	sef_startup();
	/* Fetch our endpoint */
	sys_whoami(&ep, name, 256, &priv_f);
	/* Enable IO-sensitive operations for ourselves */
	sys_enable_iop(ep);

	vg_init(0x105); /* Change to video mode */
	vg_fill(BACKGROUND);
	vg_memtobuffer();

	sprites[0]=create_sprite(spaceship,0,0);
	draw_sprite(sprites[0]);

	vg_buffertomem();
	sleep(1);

	erase_sprite(sprites[0],BACKGROUND);
	vg_buffertomem();
	sleep(1);
	//destroy_sprite(sprites[0]);

	//test_scan(); /* Rato */
	//timer_test_int(10);

	vg_exit(); /* Return to text mode */

	return 0;
}
